{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "b34dbbca-9040-4697-ac88-705537063bc8",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Homework 1\n",
    "# Joshua Lave\n",
    "# ATOC 5860 - Objective Data Analysis\n",
    "# I am not accustomed to programming in notebooks! Let's see how it goes.\n",
    "\n",
    "%matplotlib inline\n",
    "\n",
    "from math import sqrt\n",
    "import pickle\n",
    "import statistics\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "fcb6ac29-030b-4879-8599-333cc8417ba6",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.97\n"
     ]
    }
   ],
   "source": [
    "# Problem 1.a\n",
    "# Define our variables\n",
    "\n",
    "n = 0.9 # COVID negative background rate\n",
    "p = 0.1 # COVID positive background rate\n",
    "tn = 0.8 # COVID negative test accuracy rate\n",
    "tp = 0.2 # COVID negative test inaccuracy rate\n",
    "\n",
    "# Bayes Theorem\n",
    "# Read: Probability that friend is actually negative given the background COVID rate.\n",
    "\n",
    "prob_neg_true = (tn*n)/((tn*n)+(tp*p))\n",
    "\n",
    "print(round(prob_neg_true,2))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "cb6f857d-f57c-419e-aa57-98342a1e052b",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\"\\nfrom glob import glob\\nimport pickle\\n\\nimport numexpr as ne\\nimport numpy as np\\nimport xarray as xr\\n\\nmean_bt_list = []\\n\\n# To loop through a file list:\\n# file_list = sorted(glob('/{path}/{to}/{L1b}/{data}/*'))\\n# for f in file_list:\\n\\nds = xr.open_dataset('{f}')\\n\\nfk1 = float(ds.planck_fk1.data)\\nfk2 = float(ds.planck_fk2.data)\\nbc1 = float(ds.planck_bc1.data)\\nbc2 = float(ds.planck_bc2.data)\\nrad = ds.Rad.data\\n\\nbt = ne.evaluate('((b/log((a/rad)+1)-c)/d)-273.15',\\n                 {'a': fk1, 'b': fk2, 'c': bc1, 'd': bc2, 'rad': rad})\\n\\nmean_bt = round(np.nanmean(bt),3)\\nmean_bt_list.append(mean_bt)\\n\\n# To save the list:\\n# with open('Daily_Mean_BT_{YEAR}','wb') as f:\\n#   pickle.dump(mean_bt_list,f)\\n\\n\""
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Problem 1.c\n",
    "# The raw L1b products downloaded from AWS include data in the form of radiances. \n",
    "# The datasets available on github are daily, domain-averaged brightness temperatures which were converted from radiances following the procedure\n",
    "# outlined in the ABI PUG (https://www.goes-r.gov/users/docs/PUG-L1b-vol3.pdf, page 28). The code to go from L1b radiances to the supplied dataset\n",
    "# is provided in the comment block below.\n",
    "\n",
    "'''\n",
    "from glob import glob\n",
    "import pickle\n",
    "\n",
    "import numexpr as ne\n",
    "import numpy as np\n",
    "import xarray as xr\n",
    "\n",
    "mean_bt_list = []\n",
    "\n",
    "# To loop through a file list:\n",
    "# file_list = sorted(glob('/{path}/{to}/{L1b}/{data}/*'))\n",
    "# for f in file_list:\n",
    "\n",
    "ds = xr.open_dataset('{f}')\n",
    "\n",
    "fk1 = float(ds.planck_fk1.data)\n",
    "fk2 = float(ds.planck_fk2.data)\n",
    "bc1 = float(ds.planck_bc1.data)\n",
    "bc2 = float(ds.planck_bc2.data)\n",
    "rad = ds.Rad.data\n",
    "\n",
    "bt = ne.evaluate('((b/log((a/rad)+1)-c)/d)-273.15',\n",
    "                 {'a': fk1, 'b': fk2, 'c': bc1, 'd': bc2, 'rad': rad})\n",
    "\n",
    "mean_bt = round(np.nanmean(bt),3)\n",
    "mean_bt_list.append(mean_bt)\n",
    "\n",
    "# To save the list:\n",
    "# with open('Daily_Mean_BT_{YEAR}','wb') as f:\n",
    "#   pickle.dump(mean_bt_list,f)\n",
    "\n",
    "'''"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "b763c0ef-faa1-42ec-b36a-a0766e7436a1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2020 statistics: N = 30  Mean = -19.735  Std = 1.024\n",
      "2021 statistics: N = 30  Mean = -19.561  Std = 1.019\n",
      "0.6597\n"
     ]
    }
   ],
   "source": [
    "# Problem 1.c (continued)\n",
    "# Now we can compare the sample means.\n",
    "\n",
    "with open('Daily_Mean_BT_2020','rb') as f:\n",
    "    Daily_Mean_BT_2020 = pickle.load(f)\n",
    "    \n",
    "with open('Daily_Mean_BT_2021','rb') as f:\n",
    "    Daily_Mean_BT_2021 = pickle.load(f)\n",
    "\n",
    "# Find N, mean, and std for each sample\n",
    "\n",
    "N_2020 = len(Daily_Mean_BT_2020)\n",
    "mean_2020 = round(statistics.mean(Daily_Mean_BT_2020),3)\n",
    "std_2020 = round(statistics.stdev(Daily_Mean_BT_2020),3)\n",
    "\n",
    "print('2020 statistics: N = '+str(N_2020)+ '  Mean = '+str(mean_2020)+'  Std = '+str(std_2020))\n",
    "\n",
    "N_2021 = len(Daily_Mean_BT_2021)\n",
    "mean_2021 = round(statistics.mean(Daily_Mean_BT_2021),3)\n",
    "std_2021 = round(statistics.stdev(Daily_Mean_BT_2021),3)\n",
    "\n",
    "print('2021 statistics: N = '+str(N_2021)+ '  Mean = '+str(mean_2021)+'  Std = '+str(std_2021))\n",
    "\n",
    "# Calculate the z-statistic\n",
    "\n",
    "z = ((mean_2021-mean_2020)-0)/sqrt((std_2021**2)/N_2021+(std_2020**2)/N_2020)\n",
    "print(round(z,4))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "f5857a61-4724-4922-be03-f3169cef9c98",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "95% confidence interval: -20.101 to -19.369\n"
     ]
    }
   ],
   "source": [
    "# Problem 1.d\n",
    "# Just a quick confidence interval calculation\n",
    "\n",
    "lower = round(mean_2020-1.96*(std_2020/sqrt(N_2020)),3)\n",
    "upper = round(mean_2020+1.96*(std_2020/sqrt(N_2020)),3)\n",
    "\n",
    "print('95% confidence interval: '+str(lower)+' to '+str(upper))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "af264131-9139-46ba-b19a-9e8d199fc324",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The f-score is: 1.01\n"
     ]
    }
   ],
   "source": [
    "# Problem 1.e\n",
    "# Just a quick f-score calculation\n",
    "\n",
    "f = round((std_2020**2)/(std_2021**2),3)\n",
    "\n",
    "print('The f-score is: '+str(f))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "2151b688-8613-4426-8c5d-ca9aa91a80ed",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>P_hPa</th>\n",
       "      <th>R_inches</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>842.63</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>842.58</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>842.13</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>842.38</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>842.57</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8755</th>\n",
       "      <td>850.60</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8756</th>\n",
       "      <td>850.54</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8757</th>\n",
       "      <td>850.17</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8758</th>\n",
       "      <td>850.09</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8759</th>\n",
       "      <td>849.71</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8760 rows Ã— 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       P_hPa  R_inches\n",
       "0     842.63       0.0\n",
       "1     842.58       0.0\n",
       "2     842.13       0.0\n",
       "3     842.38       0.0\n",
       "4     842.57       0.0\n",
       "...      ...       ...\n",
       "8755  850.60       0.0\n",
       "8756  850.54       0.0\n",
       "8757  850.17       0.0\n",
       "8758  850.09       0.0\n",
       "8759  849.71       0.0\n",
       "\n",
       "[8760 rows x 2 columns]"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Now on to problem 2\n",
    "# Problem 2.a\n",
    "\n",
    "# First read in the data and look at the data!\n",
    "# Its always a good idea with pandas to check that column names and indexes are what we expect.\n",
    "\n",
    "data = pd.read_csv('homework1_data.csv')\n",
    "data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "74a1462f-b4c2-4c11-ab93-11681b47a8cd",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Mean pressure during all hours: 846.332\n",
      "Mean pressure during rain hours: 847.031\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "Text(0, 0.5, 'Frequency')"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Problem 2.a continued\n",
    "\n",
    "# Find the mean pressure during all times and just during precipitation.\n",
    "\n",
    "p_mean_all = round(data.P_hPa.mean(),3)\n",
    "p_mean_rain = round(data[data['R_inches'] >= 0.01].P_hPa.mean(),3)\n",
    "\n",
    "print('Mean pressure during all hours: '+str(p_mean_all))\n",
    "print('Mean pressure during rain hours: '+str(p_mean_rain))\n",
    "\n",
    "# We can also plot a histogram of the population distribution\n",
    "\n",
    "data.P_hPa.hist(bins=30)\n",
    "plt.title('Pressure Distribution during all Observations')\n",
    "plt.xlabel('Pressure (hPa)')\n",
    "plt.ylabel('Frequency')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "f0f0e878-d6dd-4ba9-9c81-3a5213ddac0a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "For all observations - \n",
      "Mean pressure: 846.332\n",
      "Pressure standard deviation: 5.617\n",
      "Number of observations: 8760\n",
      "\n",
      "For rain observations - \n",
      "Mean pressure: 847.031\n",
      "Pressure standard deviation: 5.386\n",
      "Number of observations: 384\n",
      "\n",
      "Z = 2.439\n",
      "\n",
      "z-statistic 95% confidence interval: 845.77 to 846.894\n",
      "t-statistic 95% confidence interval: 845.769 to 846.895\n"
     ]
    }
   ],
   "source": [
    "# Problem 2.b\n",
    "\n",
    "# Here we are going to define confidence intervals using the z and t statistics.\n",
    "# We first need to define our set of variables\n",
    "\n",
    "# Stats for all observations\n",
    "p_mean_all = round(data.P_hPa.mean(),3)\n",
    "p_std_all = round(data.P_hPa.std(),3)\n",
    "p_N_all = len(data.P_hPa)\n",
    "\n",
    "# Stats for rain observations\n",
    "p_mean_rain = round(data[data['R_inches'] >= 0.01].P_hPa.mean(),3)\n",
    "p_std_rain = round(data[data['R_inches'] >= 0.01].P_hPa.std(),3)\n",
    "p_N_rain = len(data[data['R_inches'] >= 0.01].P_hPa)\n",
    "\n",
    "print('For all observations - ')\n",
    "print('Mean pressure: '+str(p_mean_all))\n",
    "print('Pressure standard deviation: '+str(p_std_all))\n",
    "print('Number of observations: '+str(p_N_all)+'\\n')\n",
    "\n",
    "print('For rain observations - ')\n",
    "print('Mean pressure: '+str(p_mean_rain))\n",
    "print('Pressure standard deviation: '+str(p_std_rain))\n",
    "print('Number of observations: '+str(p_N_rain)+'\\n')\n",
    "\n",
    "# Since we are looking for anomalous pressure, we will use a two-tailed test.\n",
    "# At 384 observations, our t-stat has converged to the corresponding z-stat to two decimal places.\n",
    "\n",
    "z_c = 1.96\n",
    "t_c = 1.96\n",
    "\n",
    "# Now we can calculate a z-score\n",
    "z = round((p_mean_rain-p_mean_all)/(p_std_all/sqrt(p_N_rain)),3)\n",
    "\n",
    "print('Z = '+str(z)+'\\n')\n",
    "\n",
    "# We can also calculate confidence intervals around the sample mean for samples of size p_N_rain\n",
    "\n",
    "# z-statistic...\n",
    "lower_z = round(p_mean_all-1.96*(p_std_all/sqrt(p_N_rain)),3)\n",
    "upper_z = round(p_mean_all+1.96*(p_std_all/sqrt(p_N_rain)),3)\n",
    "\n",
    "# t-statistic...\n",
    "lower_t = round(p_mean_all-1.96*(p_std_all/sqrt(p_N_rain-1)),3)\n",
    "upper_t = round(p_mean_all+1.96*(p_std_all/sqrt(p_N_rain-1)),3)\n",
    "\n",
    "print('z-statistic 95% confidence interval: '+str(lower_z)+' to '+str(upper_z))\n",
    "print('t-statistic 95% confidence interval: '+str(lower_t)+' to '+str(upper_t))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "60c17f2e-f918-462c-aa8f-922e07a70f20",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Bootstrap mean: 846.33\n",
      "Bootstrap standard deviation: 0.285\n",
      "\n",
      "Z-statistic (number of standard errors that the sample mean deviates from the population mean): 2.46\n",
      "\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Problem 3.c\n",
    "\n",
    "# Generate a set of means of random samples of size p_N_rain. That is, bootstrap!\n",
    "\n",
    "Ns = 10000\n",
    "bs_list = []\n",
    "for n in range(Ns):\n",
    "    bs_list.append(np.random.choice(data.P_hPa,p_N_rain).mean())\n",
    "\n",
    "# Let's take a look at our bootstrapped distribution.    \n",
    "\n",
    "plt.hist(bs_list,bins=30)\n",
    "plt.title('Bootstrapped Mean Pressure Distribution')\n",
    "plt.xlabel('Pressure (hPa)')\n",
    "plt.ylabel('Frequency')\n",
    "\n",
    "# Generate a few statistics about the bootstrapped distribution.\n",
    "\n",
    "bs_list_mean = round(statistics.mean(bs_list),3)\n",
    "bs_list_std = round(statistics.stdev(bs_list),3)\n",
    "\n",
    "print('Bootstrap mean: '+str(bs_list_mean))\n",
    "print('Bootstrap standard deviation: '+str(bs_list_std)+'\\n')\n",
    "\n",
    "# Now we can calculate the z-statistic\n",
    "\n",
    "z_rain = round((p_mean_rain-bs_list_mean)/bs_list_std,3)\n",
    "\n",
    "print('Z-statistic (number of standard errors that the sample mean deviates from the population mean): '+str(z_rain)+'\\n')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9b883bb7-f270-4a90-b5ce-336952dcb43c",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5308b3b9-1e99-41e7-82cf-f4dc3fad39ce",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
